<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Example Mole Fetch</title>
</head>
<button id="test-fetch">Fetch Facebook</button>
<div id="result"></div>

<body>
    <script type="module">
    import {MoleFetch} from '/mole-fetch.min.js';
    const moleFetch = new MoleFetch()

    const testFetch = async () => {
        //Call sendRequest for request HTTP
        moleFetch.sendRequest('test-fetch', '/online', {}, {
            start: {
                title: 'Test Fetch',
                body: 'Test Fetch is processing...',
            },
            finished: {
                title: 'Test Fetch',
                body: 'Test Fetch is finished.',
            },
        })
    }

    //Register ServiceWoker
    if ('serviceWorker' in navigator && 'SyncManager' in window) {
        navigator.serviceWorker.register("sw.js",{type: 'module'}).then((registration) => {
            console.log('ServiceWorker registration successful with scope: ', registration.scope)
        }).catch(function(err) {
            console.error('ServiceWorker registration failed: ', err)
        })
    }

    //Implement onResponse for recieve response from ServiceWorker when site is online
    moleFetch.onResponse('test-fetch').then((value) => {
        document.getElementById("result").innerHTML = value;
    })

    //Implement onResponse for recieve response from Cache when site is offline
    moleFetch.getCacheResponse('test-fetch',false).then((value) => {
        document.getElementById("result").innerHTML = value;
    })

    document.getElementById('test-fetch').addEventListener('click', testFetch)

    </script>
</body>

</html>
