<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Example Mole Fetch</title>
</head>
<button id="test-fetch">Test fetch</button>
<div id="result"></div>

<body>
    <script type="module">
    import {MoleFetchClient} from '/mole-fetch.min.js';
    const moleFetch = new MoleFetchClient()
    moleFetch.debug = true
    const testFetch = async () => {
        //Call sendRequest for request HTTP
        const response = await moleFetch.sendRequest('test-fetch', '/online', {}, {
            start: {
                title: 'Test Fetch',
                options: { body: 'Test Fetch is processing...' },
            },
            finished: {
                title: 'Test Fetch',
                options: { body: 'Test Fetch is finished.' },
            },
        })
        document.getElementById("result").innerHTML = JSON.stringify(response);
    }

    //Register ServiceWoker
    if ('serviceWorker' in navigator && 'SyncManager' in window) {
        await navigator.serviceWorker.register("sw.js",{type: 'module'})
    }

    //Implement onResponse for recieve response from Cache when site is offline
    moleFetch.getCacheResponse('test-fetch',false).then((value) => {
        document.getElementById("result").innerHTML = JSON.stringify(value);
    })

    document.getElementById('test-fetch').addEventListener('click', testFetch)

    </script>
</body>

</html>
